### Apache
FROM    ubuntu:12.04

RUN echo 'deb http://archive.ubuntu.com/ubuntu precise main universe' > /etc/apt/sources.list
RUN apt-get update

# Essentials
RUN apt-get install -y -q git vim aptitude wget

# Setup SSH Server
RUN apt-get install -y openssh-server
RUN mkdir -p /var/run/sshd
RUN mkdir -p /root/.ssh
ADD id_rsa.pub /root/.ssh/authorized_keys
RUN chmod 600 /root/.ssh/authorized_keys
RUN chown root:root /root/.ssh/authorized_keys
RUN echo 'AuthorizedKeysFile   /root/.ssh/authorized_keys' > /etc/ssh/sshd_config
RUN echo 'PermitRootLogin without-password' > /etc/ssh/sshd_config

# Setup Apache
RUN apt-get -y install libapache2-mod-jk

EXPOSE 22
EXPOSE 80
EXPOSE 443

ENV APACHE_RUN_USER www-data
ENV APACHE_RUN_GROUP www-data
ENV APACHE_LOG_DIR /var/log/apache2

ENTRYPOINT ["/usr/sbin/apache2"]
CMD ["-D", "FOREGROUND"]

### Extra

# Setup Webmin
#RUN wget http://prdownloads.sourceforge.net/webadmin/webmin_1.660_all.deb
